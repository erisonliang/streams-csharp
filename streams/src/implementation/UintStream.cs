//======================================================================================================================
namespace hhlogic.streams.implementation {
//----------------------------------------------------------------------------------------------------------------------
using System;
//======================================================================================================================


//======================================================================================================================
public sealed class UintStream : AbstractStream<uint>
{
  //--------------------------------------------------------------------------------------------------------------------
  private readonly uint rangeStartInclusive;
  private readonly uint rangeEndExclusive;
  //--------------------------------------------------------------------------------------------------------------------
  public UintStream(uint rangeStartInclusive, uint rangeEndExclusive)
  {
    this.rangeStartInclusive = rangeStartInclusive < rangeEndExclusive? rangeStartInclusive : rangeEndExclusive;
    this.rangeEndExclusive = rangeEndExclusive;
  }
  //--------------------------------------------------------------------------------------------------------------------
  public override bool forEachWhile(Predicate<uint> f)
  {
    for(uint i = rangeStartInclusive; i < rangeEndExclusive; i++)
      if(!f(i))
        return false;

    return true;
  }
  //--------------------------------------------------------------------------------------------------------------------
  public override Maybe<uint> fastCount()
  {
    return Maybe.of(rangeEndExclusive - rangeStartInclusive);
  }
  //--------------------------------------------------------------------------------------------------------------------
  public override Maybe<uint> last()
  {
    return fastCount().filter(i => i > 0).map(i => rangeEndExclusive - 1);
  }
  //--------------------------------------------------------------------------------------------------------------------
  public override Maybe<uint> head()
  {
    return fastCount().filter(i => i > 0).map(i => rangeStartInclusive);
  }
  //--------------------------------------------------------------------------------------------------------------------
  public override Stream<uint> tail()
  {
    return fastCount()
      .filter(i => i > 0)
      .flatMap(i => (Stream<uint>) new UintStream(rangeStartInclusive + 1, rangeEndExclusive));
  }
  //--------------------------------------------------------------------------------------------------------------------
  public override Stream<uint> snapshot()
  {
    return this;
  }
  //--------------------------------------------------------------------------------------------------------------------
}
//======================================================================================================================


//======================================================================================================================
} // End Namespace
//======================================================================================================================
